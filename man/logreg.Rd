% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ecwm.R
\name{logreg}
\alias{logreg}
\title{A logistic regression model for the ECWM}
\usage{
logreg(formula, data, prob_var)
}
\arguments{
\item{formula}{a "\code{\link{formula}}" in the form
\code{response ~ terms}, where \code{response} is the response
variable and \code{terms} describes the linear predictor. The
response variable should be numeric with the values 1 for
"One Yes answer" and 2 for "Two No or two Yes answers".}

\item{data}{data frame with individual records containing the response
and \code{prob_var} variables, and the predictors.}

\item{prob_var}{name of the variable with the individual probabilities
of answering "Yes" to the unrelated question.}
}
\value{
A list with the following objects:
\describe{
\item{coefs}{data frame with the parameter estimates.}
\item{gof}{fit statistics including the log-likelihood, AIC and a likelihood-ratio
test against the intercept-only model.}
\item{fitted}{vector with the estimated probabilities.}
\item{cormat}{correlation matrix of the parameter estimates.}
\item{D}{design matrix of the fitted model.}
}
}
\description{
Fits a logistic regression model to data collected with the
extended crosswise model, and predicts the probability of the sensitive
characteristic conditional on the predictors.
}
\details{
Maximization of the log-likelihood may fail when the population
prevalence estimate is close to the boundary, resulting in a
non-invertible Hessian matrix. In that case the standard errors are set
to \code{NA}s, and a warning is issued that the solution is not reliable.
}
\examples{
logreg(formula = Q1 ~ Time + Difficult, data = doping, prob_var = P1)

# Separate prevalence estimates for each sub-sample, which yields the
# same LR statistic as the function 'prev'

logreg(formula = Q1 ~ factor(P1), data = doping, prob_var = P1)

}
